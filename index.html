<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI love reuse</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root {
            --primary: #667eea; --secondary: #764ba2; --accent: #00bcd4; --accent-light: #4dd0e1;
            --green: #27AE60; --green-dark: #229954; --white: #ffffff; --dark: #1a1a2e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif; line-height: 1.6;
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 50%, #1b5e20 100%);
            background-size: 400% 400%; animation: gradientShift 15s ease infinite;
            color: var(--white); min-height: 100vh;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; }
        }

        header {
            position: fixed; top: 0; width: 100%; padding: 1rem 5%;
            background: rgba(102, 126, 234, 0.1); backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1); z-index: 1000;
            transition: all 0.3s ease;
        }

        nav {
            display: flex; justify-content: space-between; align-items: center;
            max-width: 1200px; margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem; font-weight: 800; color: white;
            display: flex; align-items: center; gap: 0.8rem;
        }

        .logo-icon {
            width: 45px; height: 45px; background: linear-gradient(135deg, var(--accent), var(--accent-light));
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; animation: pulse 2s infinite;
        }

        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        .nav-pills {
            display: flex; background: rgba(255, 255, 255, 0.1); padding: 0.5rem;
            border-radius: 50px; backdrop-filter: blur(10px); gap: 0.5rem; margin-right: 2rem;
        }

        .nav-pill {
            padding: 0.7rem 1.5rem; border-radius: 25px; color: white; text-decoration: none;
            font-weight: 500; transition: all 0.3s ease; font-size: 0.9rem;
        }

        .nav-pill:hover, .nav-pill.active {
            background: rgba(255, 255, 255, 0.2); transform: translateY(-2px);
        }

        .hamburger {
            display: none; flex-direction: column; cursor: pointer; padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1); border-radius: 8px; margin-right: 1rem;
            transition: all 0.3s ease;
        }

        .hamburger:hover { background: rgba(255, 255, 255, 0.2); }

        .hamburger-line {
            width: 25px; height: 3px; background-color: white; margin: 3px 0;
            transition: all 0.3s ease; border-radius: 2px;
        }

        .hamburger.active .hamburger-line:nth-child(1) { transform: rotate(45deg) translate(8px, 8px); }
        .hamburger.active .hamburger-line:nth-child(2) { opacity: 0; }
        .hamburger.active .hamburger-line:nth-child(3) { transform: rotate(-45deg) translate(7px, -6px); }

        .mobile-menu {
            position: fixed; top: 0; left: -100%; width: 80%; max-width: 350px; height: 100vh;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.98), rgba(118, 75, 162, 0.95));
            backdrop-filter: blur(20px); z-index: 999; padding: 6rem 2rem 2rem;
            transition: left 0.3s ease; overflow-y: auto; box-shadow: 2px 0 20px rgba(0, 0, 0, 0.3);
        }

        .mobile-menu.active { left: 0; }

        .mobile-menu-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: rgba(0, 0, 0, 0.5); z-index: 998; opacity: 0;
            visibility: hidden; transition: all 0.3s ease;
        }

        .mobile-menu-overlay.active { opacity: 1; visibility: visible; }

        .mobile-nav-pill {
            display: block; padding: 1.2rem 1.5rem; margin-bottom: 0.5rem;
            color: white; text-decoration: none; font-weight: 500; font-size: 1.1rem;
            border-radius: 15px; transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .mobile-nav-pill:hover, .mobile-nav-pill.active {
            background: rgba(0, 188, 212, 0.2); border-color: var(--accent);
            transform: translateX(10px);
        }

        .mobile-menu-header {
            margin-bottom: 2rem; padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .mobile-menu-header h3 { color: var(--accent); font-size: 1.5rem; font-weight: 700; }

        .google-login-btn {
            background: white; color: #333; padding: 0.8rem 2rem; border: none; border-radius: 50px;
            font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex;
            align-items: center; gap: 0.8rem; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .google-login-btn:hover { 
            transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15); 
        }

        .google-login-btn::before,
        .google-login-btn::after,
        .google-login-btn:hover::before,
        .google-login-btn:hover::after {
            display: none !important; content: none !important;
        }

        .user-info { display: none; align-items: center; gap: 1rem; }
        .user-avatar { width: 35px; height: 35px; border-radius: 50%; border: 2px solid white; }

        section { padding: 6rem 5%; position: relative; z-index: 2; }
        .section-container { max-width: 1200px; margin: 0 auto; text-align: center; }
        .section-title h2 { font-size: 2.5rem; font-weight: 800; margin-bottom: 1rem; }
        .section-subtitle { font-size: 1.2rem; opacity: 0.8; margin-bottom: 4rem; max-width: 600px; margin-left: auto; margin-right: auto; }

        .hero {
            min-height: 100vh; display: flex; flex-direction: column; align-items: center;
            justify-content: center; text-align: center; padding: 6rem 2rem 4rem;
        }

        .hero h1 { font-size: clamp(2.5rem, 6vw, 4rem); font-weight: 800; margin-bottom: 1rem; line-height: 1.2; }
        .hero-subtitle { font-size: 1.3rem; margin-bottom: 0.5rem; opacity: 0.9; font-weight: 600; }
        .hero-description { font-size: 1.1rem; margin-bottom: 3rem; opacity: 0.8; line-height: 1.6; max-width: 700px; }

        .hero-button {
            padding: 1.2rem 3rem; background: linear-gradient(135deg, var(--accent), var(--accent-light));
            border: none; border-radius: 50px; color: white; font-weight: 600; font-size: 1.1rem;
            cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center;
            gap: 0.8rem; margin-bottom: 4rem; text-decoration: none;
        }

        .hero-button:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(0, 188, 212, 0.4); }

        .stats {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem; max-width: 800px; margin: 0 auto;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1); padding: 2rem 1rem; border-radius: 20px;
            backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease; text-align: center;
        }

        .stat-item:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.15); }
        .stat-number { font-size: 2.5rem; font-weight: 900; color: var(--accent); margin-bottom: 0.5rem; display: block; }
        .stat-label { font-size: 1rem; opacity: 0.9; font-weight: 500; }

        .impact-section { background: rgba(0, 0, 0, 0.1); backdrop-filter: blur(10px); }
        .impact-bars { max-width: 800px; margin: 0 auto; text-align: left; }

        .impact-item {
            margin-bottom: 2rem; background: rgba(255, 255, 255, 0.1); padding: 1.5rem;
            border-radius: 15px; backdrop-filter: blur(10px);
        }

        .impact-label { display: flex; justify-content: space-between; margin-bottom: 1rem; font-weight: 600; }
        .impact-bar { height: 16px; background-color: rgba(255, 255, 255, 0.2); border-radius: 10px; overflow: hidden; }
        .impact-fill { height: 100%; border-radius: 10px; width: 0; transition: width 1.5s ease-in-out; }

        .impact-item:nth-child(1) .impact-fill { background: linear-gradient(90deg, #ff6b6b, #ff5252); }
        .impact-item:nth-child(2) .impact-fill { background: linear-gradient(90deg, #4ecdc4, #26a69a); }
        .impact-item:nth-child(3) .impact-fill { background: linear-gradient(90deg, #ffd166, #ffb300); }
        .impact-item:nth-child(4) .impact-fill { background: linear-gradient(90deg, #a8e6cf, #66bb6a); }

        .pricing-section { background: rgba(0, 0, 0, 0.05); backdrop-filter: blur(10px); }

        .pricing-cards {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 3rem; max-width: 900px; margin: 0 auto;
        }

        .pricing-card {
            background: rgba(255, 255, 255, 0.1); border-radius: 25px; padding: 3rem 2rem;
            backdrop-filter: blur(20px); border: 2px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease; text-align: center; position: relative;
        }

        .pricing-card:hover { transform: translateY(-10px); background: rgba(255, 255, 255, 0.15); }
        .pricing-card.premium { border-color: #ffc107; box-shadow: 0 0 30px rgba(255, 193, 7, 0.3); }

        .pricing-badge {
            position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
            background: #ffc107; color: #333; padding: 0.5rem 1.5rem; border-radius: 20px;
            font-size: 0.9rem; font-weight: 700;
        }

        .pricing-icon { font-size: 3.5rem; margin-bottom: 1.5rem; color: var(--accent); }
        .pricing-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem; }
        .pricing-price { font-size: 3rem; font-weight: 900; color: var(--accent); margin-bottom: 0.5rem; }
        .pricing-period { font-size: 1rem; opacity: 0.7; margin-bottom: 2rem; }

        .pricing-features {
            list-style: none; margin-bottom: 2.5rem; text-align: left;
            background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 1.5rem;
        }

        .pricing-features li {
            padding: 0.8rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; align-items: center; gap: 1rem;
        }

        .pricing-features li:last-child { border-bottom: none; }

        .pricing-btn {
            width: 100%; padding: 1.2rem; border: none; border-radius: 25px; font-weight: 700;
            font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease;
        }

        .pricing-btn.free {
            background: linear-gradient(135deg, var(--accent), var(--accent-light));
            color: white;
        }

        .pricing-btn.premium {
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: #333;
        }

        .pricing-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2); }

        .features-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 3rem;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1); padding: 2.5rem 2rem; border-radius: 20px;
            backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease; text-align: center;
        }

        .feature-card:hover { transform: translateY(-10px); background: rgba(255, 255, 255, 0.15); }
        .feature-icon { font-size: 3rem; color: var(--accent); margin-bottom: 1.5rem; }
        .feature-card h3 { font-size: 1.4rem; font-weight: 700; margin-bottom: 1rem; }
        .feature-card p { opacity: 0.8; line-height: 1.6; }

        .upload-section { display: block; }
        .upload-section.active { display: block; }

        .login-required {
            background: rgba(255, 193, 7, 0.15); border: 2px solid #ffc107; border-radius: 20px;
            padding: 3rem 2rem; text-align: center; margin: 2rem 0;
        }

        .login-required h3 { color: #ffc107; margin-bottom: 1rem; font-size: 1.8rem; }

        .upload-area {
            background: rgba(255, 255, 255, 0.08); border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 25px; padding: 4rem 2rem; margin: 2rem 0; backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }

        .upload-area:hover { border-color: var(--accent); background: rgba(255, 255, 255, 0.12); }

        .upload-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem; margin: 2rem 0;
        }

        .upload-item {
            background: rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 2rem 1.5rem;
            backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease; text-align: center;
        }

        .upload-item:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.15); }

        .file-input { display: none; }

        .file-label {
            display: block; padding: 1rem 2rem; background: linear-gradient(135deg, var(--accent), var(--accent-light));
            border-radius: 25px; color: white; font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .file-label:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 188, 212, 0.3); }

        .preview-area {
            margin-top: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center;
            max-height: 200px; overflow-y: auto; padding: 0.5rem; border-radius: 10px;
        }

        .preview-image {
            width: 120px; height: 120px; object-fit: cover; border-radius: 15px;
            border: 2px solid var(--accent); transition: all 0.3s ease;
        }

        .preview-image:hover { transform: scale(1.05); border-color: var(--accent-light); }

        .remove-image {
            position: absolute; top: -8px; right: -8px; background: #ff5252; color: white;
            border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer;
            font-size: 12px; display: flex; align-items: center; justify-content: center;
        }

        .footer-cta {
            background: linear-gradient(135deg, var(--green), var(--green-dark));
            padding: 4rem 5%; text-align: center; box-shadow: 0 -10px 30px rgba(39, 174, 96, 0.3);
        }

        .footer-cta h3 { font-size: 2.2rem; margin-bottom: 1rem; font-weight: 800; }
        .footer-cta p { font-size: 1.2rem; margin-bottom: 2rem; opacity: 0.9; max-width: 600px; margin-left: auto; margin-right: auto; }

        .cta-features {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem; margin: 3rem 0; max-width: 600px; margin-left: auto; margin-right: auto;
        }

        .cta-feature {
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px);
            border-radius: 15px; padding: 2rem 1.5rem; transition: transform 0.3s;
        }

        .cta-feature:hover { transform: translateY(-5px); }
        .cta-feature i { font-size: 2.5rem; margin-bottom: 1rem; color: #FFD166; }
        .cta-feature h4 { font-size: 1.3rem; margin-bottom: 0.5rem; }
        .cta-feature p { font-size: 1rem; margin: 0; opacity: 0.8; }

        .btn-primary {
            background-color: var(--white); color: var(--green); padding: 1rem 2.5rem; border-radius: 30px;
            text-decoration: none; font-weight: 700; font-size: 1.1rem; transition: all 0.3s ease;
            display: inline-flex; align-items: center; gap: 0.8rem; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-primary:hover { transform: translateY(-3px); background-color: #FFD166; color: var(--dark); }

        footer {
            background: rgba(0, 0, 0, 0.3); padding: 3rem 5% 2rem; text-align: center;
            backdrop-filter: blur(20px);
        }

        .footer-content {
            max-width: 1200px; margin: 0 auto; display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 3rem; margin-bottom: 3rem;
        }

        .footer-column h3 { font-size: 1.4rem; margin-bottom: 1.5rem; }
        .footer-column p, .footer-column a {
            color: rgba(255, 255, 255, 0.7); margin-bottom: 0.8rem; display: block;
            text-decoration: none; transition: all 0.3s ease;
        }

        .footer-column a:hover { color: var(--accent); transform: translateX(5px); }

        .social-icons { display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem; }

        .social-icons a {
            display: inline-flex; align-items: center; justify-content: center; width: 45px; height: 45px;
            background: rgba(255, 255, 255, 0.1); border-radius: 50%; transition: all 0.3s ease; font-size: 1.2rem;
        }

        .social-icons a:hover { background: var(--accent); transform: translateY(-5px); }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1); padding-top: 2rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .notification {
            position: fixed; top: 20px; right: 20px; padding: 1rem 2rem; border-radius: 15px;
            color: white; font-weight: 600; z-index: 10000; backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2); animation: slideInRight 0.3s ease;
            max-width: 350px;
        }

        .notification.success { background: linear-gradient(135deg, var(--accent), var(--accent-light)); }
        .notification.error { background: linear-gradient(135deg, #f44336, #d32f2f); }
        .notification.info { background: linear-gradient(135deg, var(--primary), var(--secondary)); }

        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .popup-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px); z-index: 10000; display: flex; align-items: center;
            justify-content: center; animation: fadeIn 0.3s ease;
        }

        .popup-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            border-radius: 25px; padding: 3rem; max-width: 600px; width: 90%; text-align: center;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.3); border: 2px solid rgba(255, 255, 255, 0.2);
            animation: slideInUp 0.4s ease; color: #333;
        }

        .popup-icon { font-size: 4rem; margin-bottom: 1.5rem; display: block; }
        .popup-title { font-size: 1.8rem; font-weight: 800; margin-bottom: 1rem; color: #d32f2f; }
        .popup-message { font-size: 1.1rem; margin-bottom: 2rem; line-height: 1.6; color: #555; }

        /* NUEVOS ESTILOS PARA VALIDACIÓN MEJORADA */
        .validation-popup .popup-title.error { color: #d32f2f; }
        .validation-popup .popup-title.warning { color: #ff9800; }
        .validation-popup .popup-title.info { color: #2196f3; }

        .validation-details {
            background: rgba(0, 0, 0, 0.05); border-radius: 15px; padding: 1.5rem;
            margin: 1.5rem 0; text-align: left; border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .validation-item {
            display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;
            padding: 1rem; background: white; border-radius: 10px;
            border-left: 4px solid var(--accent);
        }

        .validation-item:last-child { margin-bottom: 0; }

        .validation-item.error { border-left-color: #f44336; }
        .validation-item.warning { border-left-color: #ff9800; }
        .validation-item.success { border-left-color: #4caf50; }

        .validation-icon {
            font-size: 1.5rem; margin-top: 0.2rem; flex-shrink: 0;
        }

        .validation-content h4 {
            margin: 0 0 0.5rem 0; font-size: 1.1rem; font-weight: 600;
        }

        .validation-content p {
            margin: 0; font-size: 0.95rem; color: #666; line-height: 1.4;
        }

        /* TOOLTIPS MEJORADOS */
        .tooltip {
            position: relative; display: inline-block; cursor: help;
        }

        .tooltip::before {
            content: attr(data-tooltip);
            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9); color: white; padding: 0.8rem 1rem;
            border-radius: 8px; font-size: 0.9rem; white-space: nowrap;
            opacity: 0; visibility: hidden; transition: all 0.3s ease;
            z-index: 1000; margin-bottom: 5px; font-weight: 500;
        }

        .tooltip::after {
            content: '';
            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            border: 5px solid transparent; border-top-color: rgba(0, 0, 0, 0.9);
            opacity: 0; visibility: hidden; transition: all 0.3s ease;
            z-index: 1000;
        }

        .tooltip:hover::before,
        .tooltip:hover::after {
            opacity: 1; visibility: visible;
        }

        /* INDICADORES DE ESTADO MEJORADOS */
        .status-indicator {
            position: absolute; top: -8px; right: -8px;
            width: 24px; height: 24px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.8rem; font-weight: bold; color: white;
            border: 2px solid white; z-index: 10;
        }

        .status-indicator.uploading {
            background: #2196f3; animation: pulse 1.5s infinite;
        }

        .status-indicator.validating {
            background: #ff9800; animation: spin 1s linear infinite;
        }

        .status-indicator.success {
            background: #4caf50;
        }

        .status-indicator.error {
            background: #f44336;
        }

        .status-indicator.warning {
            background: #ff9800;
        }

        /* EJEMPLOS VISUALES MEJORADOS */
        .upload-examples {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem; margin-top: 1rem; opacity: 0.7;
        }

        .example-item {
            text-align: center; padding: 0.5rem; border-radius: 8px;
            background: rgba(255, 255, 255, 0.1); transition: all 0.3s ease;
        }

        .example-item:hover {
            opacity: 1; background: rgba(255, 255, 255, 0.2);
        }

        .example-item i {
            font-size: 1.5rem; color: var(--accent); margin-bottom: 0.3rem;
        }

        .example-item span {
            font-size: 0.7rem; display: block; color: rgba(255, 255, 255, 0.8);
        }

        /* LOADING STATES ESPECÍFICOS */
        .loading-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(2px);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-radius: 20px; z-index: 100;
        }

        .loading-spinner {
            width: 40px; height: 40px; border: 3px solid rgba(0, 188, 212, 0.3);
            border-top: 3px solid var(--accent); border-radius: 50%;
            animation: spin 1s linear infinite; margin-bottom: 1rem;
        }

        .loading-text {
            font-size: 0.9rem; color: #666; text-align: center;
            max-width: 200px; line-height: 1.4;
        }

        /* PROGRESS BAR */
        .progress-bar {
            width: 100%; height: 4px; background: rgba(0, 0, 0, 0.1);
            border-radius: 2px; overflow: hidden; margin-top: 1rem;
        }

        .progress-fill {
            height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent-light));
            border-radius: 2px; transition: width 0.3s ease;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }

        /* HELPER CARDS */
        .helper-card {
            background: rgba(33, 150, 243, 0.1); border: 1px solid rgba(33, 150, 243, 0.3);
            border-radius: 12px; padding: 1rem; margin: 1rem 0;
            display: flex; align-items: flex-start; gap: 0.8rem;
        }

        .helper-card.warning {
            background: rgba(255, 152, 0, 0.1); border-color: rgba(255, 152, 0, 0.3);
        }

        .helper-card.success {
            background: rgba(76, 175, 80, 0.1); border-color: rgba(76, 175, 80, 0.3);
        }

        .helper-icon {
            font-size: 1.2rem; margin-top: 0.1rem; flex-shrink: 0;
        }

        .helper-content {
            flex: 1;
        }

        .helper-content h5 {
            margin: 0 0 0.3rem 0; font-size: 0.9rem; font-weight: 600;
        }

        .helper-content p {
            margin: 0; font-size: 0.8rem; opacity: 0.8; line-height: 1.3;
        }

        .popup-buttons { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }

        .popup-btn {
            padding: 1rem 2rem; border: none; border-radius: 25px; font-weight: 700;
            font-size: 1rem; cursor: pointer; transition: all 0.3s ease; min-width: 120px;
        }

        .popup-btn-primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-light)); color: white;
        }

        .popup-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 188, 212, 0.4); }

        .popup-btn-secondary {
            background: transparent; color: #666; border: 2px solid #ddd;
        }

        .popup-btn-secondary:hover { background: #f5f5f5; border-color: #ccc; }

        @keyframes slideInUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .loading {
            display: inline-block; width: 20px; height: 20px; border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%; border-top-color: #ffffff; animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 768px) {
            .nav-pills { display: none; }
            .hamburger { display: flex; }
            .hero h1 { font-size: 2rem; }
            section { padding: 4rem 3%; }
            .pricing-cards, .features-grid { grid-template-columns: 1fr; }
            .upload-grid { grid-template-columns: 1fr; }
            .notification { max-width: 280px; font-size: 0.9rem; }
        }

        @media (max-width: 480px) {
            header { padding: 1rem 3%; }
            .hero { padding: 4rem 1rem 2rem; }
            .hero h1 { font-size: 1.8rem; }
            .popup-content { padding: 2rem; margin: 1rem; }
            .mobile-menu { width: 90%; max-width: none; }
            .notification { max-width: 250px; padding: 0.8rem 1.2rem; }
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .google-login-btn:focus, .file-label:focus, .pricing-btn:focus, .hero-button:focus {
            outline: 2px solid var(--accent); outline-offset: 2px;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <div class="logo-icon">♻️</div>
                AI love reuse
            </div>
            <div style="display: flex; align-items: center;">
                <div class="nav-pills">
                    <a href="#inicio" class="nav-pill active">🏠 Inicio</a>
                    <a href="#impacto" class="nav-pill">🌍 Impacto Ambiental</a>
                    <a href="#precios" class="nav-pill">💳 Precios</a>
                    <a href="#funcionamiento" class="nav-pill">⚙️ Cómo funciona</a>
                    <a href="#equipo" class="nav-pill">👥 Equipo</a>
                </div>
                
                <div class="hamburger" id="hamburgerBtn" onclick="toggleMobileMenu()">
                    <div class="hamburger-line"></div>
                    <div class="hamburger-line"></div>
                    <div class="hamburger-line"></div>
                </div>
                
                <div class="auth-container">
                    <div class="user-info" id="userInfo" style="display: none;">
                        <img class="user-avatar" id="userAvatar" alt="Usuario">
                        <span id="userName"></span>
                        <button onclick="logout()" style="background: transparent; border: 1px solid white; color: white; padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer;">Salir</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <div class="mobile-menu-overlay" id="mobileMenuOverlay" onclick="closeMobileMenu()"></div>
    
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <h3>AI love reuse</h3>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem;">Reutiliza tu ropa con IA</p>
        </div>
        
        <a href="#inicio" class="mobile-nav-pill active" onclick="closeMobileMenu()">
            <i class="fas fa-home" style="margin-right: 1rem;"></i>
            Inicio
        </a>
        <a href="#impacto" class="mobile-nav-pill" onclick="closeMobileMenu()">
            <i class="fas fa-globe" style="margin-right: 1rem;"></i>
            Impacto Ambiental
        </a>
        <a href="#precios" class="mobile-nav-pill" onclick="closeMobileMenu()">
            <i class="fas fa-credit-card" style="margin-right: 1rem;"></i>
            Precios
        </a>
        <a href="#funcionamiento" class="mobile-nav-pill" onclick="closeMobileMenu()">
            <i class="fas fa-cog" style="margin-right: 1rem;"></i>
            Cómo funciona
        </a>
        <a href="#equipo" class="mobile-nav-pill" onclick="closeMobileMenu()">
            <i class="fas fa-users" style="margin-right: 1rem;"></i>
            Equipo
        </a>
        <a href="#upload" class="mobile-nav-pill" onclick="closeMobileMenu()">
            <i class="fas fa-upload" style="margin-right: 1rem;"></i>
            Subir Fotos
        </a>
        
        <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255, 255, 255, 0.2);">
            <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; text-align: center; margin-bottom: 1rem;">
                ♻️ Maximiza tu ropa, minimiza tu impacto ambiental
            </p>
        </div>
    </div>

    <section id="inicio" class="hero">
        <div style="max-width: 900px; animation: fadeInUp 1s ease;">
            <span style="font-size: 4rem; margin-bottom: 1rem; display: block;">♻️👕</span>
            <h1>Reutiliza tu ropa con IA y minimiza tu Impacto Ambiental</h1>
            <p class="hero-subtitle">¿Tardas mucho eligiendo qué ponerte cada mañana?</p>
            <p class="hero-description">Descubre combinaciones únicas con tu ropa actual gracias a nuestra inteligencia artificial. Sin estrés, sin pérdida de tiempo, solo outfits perfectos que cuidan el planeta.</p>
            
            <a href="#upload" class="hero-button" onclick="handleStartNowClick(event)">🚀 Empezar Ahora - Es Gratis</a>
            
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number">15min</span>
                    <span class="stat-label">Ahorrados cada mañana</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">10s</span>
                    <span class="stat-label">Para generar outfit</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">25kg</span>
                    <span class="stat-label">Reduce CO₂ por cada kilo reutilizado</span>
                </div>
            </div>
        </div>
    </section>

    <section id="impacto" class="impact-section">
        <div class="section-container">
            <div class="section-title">
                <h2>🌍 Impacto Ambiental</h2>
                <p class="section-subtitle">La industria de la moda es una de las más contaminantes. Reutilizar tu ropa tiene un Impacto Ambiental positivo inmediato en el medio ambiente</p>
            </div>
            
            <div class="impact-bars">
                <div class="impact-item">
                    <div class="impact-label"><span>Reducción en consumo de agua</span><span>85%</span></div>
                    <div class="impact-bar"><div class="impact-fill" data-width="85"></div></div>
                </div>
                <div class="impact-item">
                    <div class="impact-label"><span>Menos emisiones de CO₂</span><span>72%</span></div>
                    <div class="impact-bar"><div class="impact-fill" data-width="72"></div></div>
                </div>
                <div class="impact-item">
                    <div class="impact-label"><span>Reducción residuos textiles</span><span>68%</span></div>
                    <div class="impact-bar"><div class="impact-fill" data-width="68"></div></div>
                </div>
                <div class="impact-item">
                    <div class="impact-label"><span>Menos uso de químicos</span><span>63%</span></div>
                    <div class="impact-bar"><div class="impact-fill" data-width="63"></div></div>
                </div>
            </div>
        </div>
    </section>

    <section id="precios" class="pricing-section">
        <div class="section-container">
            <div class="section-title">
                <h2>💳 Precios Simples y Claros</h2>
                <p class="section-subtitle">Elige el plan que mejor se adapte a tu estilo de vida</p>
            </div>
            
            <div class="pricing-cards">
                <div class="pricing-card">
                    <div class="pricing-icon">🎁</div>
                    <h3 class="pricing-title">Plan Free</h3>
                    <div class="pricing-price">Gratis</div>
                    <div class="pricing-period">Primer mes completo</div>
                    
                    <ul class="pricing-features">
                        <li>✅ 30 combinaciones incluidas</li>
                        <li>✅ Análisis básico de IA</li>
                        <li>✅ 3 prendas superiores</li>
                        <li>✅ 3 prendas inferiores</li>
                        <li>✅ 5 zapatos diferentes</li>
                        <li>✅ Recomendaciones instantáneas</li>
                        <li>✅ Sin compromiso</li>
                    </ul>
                    
                    <button class="pricing-btn free" onclick="startFreePlan()">
                        Empezar Gratis
                    </button>
                </div>
                
                <div class="pricing-card premium">
                    <div class="pricing-badge">Más Popular</div>
                    <div class="pricing-icon">⭐</div>
                    <h3 class="pricing-title">Plan Premium</h3>
                    <div class="pricing-price">$5,000</div>
                    <div class="pricing-period">por mes</div>
                    
                    <ul class="pricing-features">
                        <li>🚀 Combinaciones ilimitadas</li>
                        <li>🧠 IA avanzada personalizada</li>
                        <li>👗 Prendas ilimitadas</li>
                        <li>👠 Zapatos ilimitados</li>
                        <li>⚡ Análisis en tiempo real</li>
                        <li>🎨 Sugerencias de estilo</li>
                        <li>📱 Soporte prioritario</li>
                    </ul>
                    
                    <button class="pricing-btn premium" onclick="upgradeToPremium()">
                        Actualizar a Premium
                    </button>
                </div>
            </div>
        </div>
    </section>

    <section id="funcionamiento">
        <div class="section-container">
            <div class="section-title">
                <h2>⚙️ Cómo Funciona</h2>
                <p class="section-subtitle">Descubre combinaciones únicas con tu ropa actual en solo tres simples pasos</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">📱</div>
                    <h3>1. Sube tus prendas</h3>
                    <p>Fotografía las prendas que quieres incluir: superiores, inferiores y calzado</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🤖</div>
                    <h3>2. IA genera combinaciones</h3>
                    <p>Nuestro algoritmo analiza colores, estilos y tendencias para crear outfits únicos</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">✨</div>
                    <h3>3. Recibe sugerencias</h3>
                    <p>Obtén recomendaciones personalizadas en menos de 10 segundos</p>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 3rem;">
                <a href="#upload" class="hero-button" onclick="handleStartNowClick(event)">Ver Mis Combinaciones</a>
            </div>
        </div>
    </section>

    <section id="upload" class="upload-section">
        <div class="section-container">
            <h2 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 1rem;">✨ Termina con el Drama Matutino</h2>
            <p style="font-size: 1.2rem; opacity: 0.8; margin-bottom: 2rem;">Sube fotos de la ropa que ya tienes y descubre combinaciones increíbles que no sabías que existían</p>
            
            <div id="loginRequired" class="login-required" style="display: none;">
                <h3>🔐 Inicia sesión para continuar</h3>
                <p>Accede con Google para usar nuestro algoritmo de IA que revolucionará tus mañanas</p>
                <button class="google-login-btn" onclick="loginWithGoogle()" style="margin-top: 1rem;">
                    <svg width="18" height="18" viewBox="0 0 18 18">
                        <path fill="#4285F4" d="M17.64 9.20454546c0-.63818182-.05727273-1.25181818-.16363636-1.84090909H9v3.48090909h4.84378348c-.20892443.95363636-.84317059 1.76772727-1.68345427 2.31181818V15.52H14.88699909C16.67543111 13.84363636 17.64 11.7093333 17.64 9.20454546z"/>
                        <path fill="#34A853" d="M9 18c2.43 0 4.467-.80727273 5.95636364-2.18545455l-2.90909091-2.25818182c-.80636364.54-1.83727273.85909091-3.04727273.85909091-2.34545455 0-4.32818182-1.58545455-5.03636364-3.71818182L.68181818 12.5218182C2.24909091 15.5981818 5.48090909 18 9 18z"/>
                        <path fill="#FBBC04" d="M3.96363636 10.7109091c-.18-.54-.28363636-1.11818182-.28363636-1.7109091s.10363636-1.17090909.28363636-1.7109091V5.28181818L.68181818 5.28181818C.24727273 6.1418182 0 7.04727273 0 8s.24727273 1.8581818.68181818 2.7181818l3.28181818-1.27090909z"/>
                        <path fill="#EA4335" d="M9 3.57272727c1.32272727 0 2.50909091.45454545 3.44363636 1.34727273l2.58181818-2.58181818C13.46363636.89090909 11.42727273 0 9 0 5.48090909 0 2.24909091 2.40181818.68181818 5.28181818l3.28181818 1.27090909C4.67181818 5.15636364 6.65454545 3.57272727 9 3.57272727z"/>
                    </svg>
                    Acceder con Google
                </button>
            </div>

            <div class="upload-area" id="uploadArea" style="display: none;">
                <!-- Helper Card con Instrucciones Mejoradas -->
                <div class="helper-card">
                    <div class="helper-icon">💡</div>
                    <div class="helper-content">
                        <h5>Consejos para mejores resultados</h5>
                        <p>Usa fotos con buena iluminación, fondo neutro y la prenda bien visible. Evita fotos con personas o múltiples prendas.</p>
                    </div>
                </div>

                <div class="upload-grid">
                    <div class="upload-item" id="tops-upload-area">
                        <div class="status-indicator" id="tops-status" style="display: none;"></div>
                        
                        <i class="fas fa-tshirt tooltip" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 1rem;" 
                           data-tooltip="Prendas superiores: camisas, blusas, chaquetas, suéteres"></i>
                        
                        <h4>Parte Superior</h4>
                        <p>Camisas, blusas, suéteres</p>
                        
                        <!-- Ejemplos Visuales -->
                        <div class="upload-examples">
                            <div class="example-item">
                                <i class="fas fa-tshirt"></i>
                                <span>Camiseta</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-user-tie"></i>
                                <span>Camisa</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-vest"></i>
                                <span>Blusa</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-jacket"></i>
                                <span>Chaqueta</span>
                            </div>
                        </div>
                        
                        <label for="tops-upload" class="file-label" id="tops-label">📤 Subir Superiores (máx 3)</label>
                        <input type="file" id="tops-upload" class="file-input" accept="image/*" multiple onchange="handleFileUpload('tops', this)">
                        
                        <div id="tops-preview" class="preview-area"></div>
                        
                        <!-- Loading Overlay -->
                        <div id="tops-loading" class="loading-overlay" style="display: none;">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">Validando prenda superior...</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-item" id="bottoms-upload-area">
                        <div class="status-indicator" id="bottoms-status" style="display: none;"></div>
                        
                        <i class="fas fa-user-tie tooltip" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 1rem;" 
                           data-tooltip="Prendas inferiores: pantalones, faldas, shorts, leggins"></i>
                        
                        <h4>Parte Inferior</h4>
                        <p>Pantalones, faldas, shorts</p>
                        
                        <!-- Ejemplos Visuales -->
                        <div class="upload-examples">
                            <div class="example-item">
                                <i class="fas fa-male"></i>
                                <span>Pantalón</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-female"></i>
                                <span>Falda</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-cut"></i>
                                <span>Shorts</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-running"></i>
                                <span>Leggings</span>
                            </div>
                        </div>
                        
                        <label for="bottoms-upload" class="file-label" id="bottoms-label">📤 Subir Inferiores (máx 3)</label>
                        <input type="file" id="bottoms-upload" class="file-input" accept="image/*" multiple onchange="handleFileUpload('bottoms', this)">
                        
                        <div id="bottoms-preview" class="preview-area"></div>
                        
                        <!-- Loading Overlay -->
                        <div id="bottoms-loading" class="loading-overlay" style="display: none;">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">Validando prenda inferior...</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-item" id="shoes-upload-area">
                        <div class="status-indicator" id="shoes-status" style="display: none;"></div>
                        
                        <i class="fas fa-shoe-prints tooltip" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 1rem;" 
                           data-tooltip="Calzado: zapatos, sneakers, botas, sandalias, tacones"></i>
                        
                        <h4>Calzado</h4>
                        <p>Zapatos, sneakers, botas</p>
                        
                        <!-- Ejemplos Visuales -->
                        <div class="upload-examples">
                            <div class="example-item">
                                <i class="fas fa-shoe-prints"></i>
                                <span>Sneakers</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-hiking"></i>
                                <span>Botas</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-high-heel"></i>
                                <span>Tacones</span>
                            </div>
                            <div class="example-item">
                                <i class="fas fa-socks"></i>
                                <span>Zapatos</span>
                            </div>
                        </div>
                        
                        <label for="shoes-upload" class="file-label" id="shoes-label">📤 Subir Zapatos (máx 5)</label>
                        <input type="file" id="shoes-upload" class="file-input" accept="image/*" multiple onchange="handleFileUpload('shoes', this)">
                        
                        <div id="shoes-preview" class="preview-area"></div>
                        
                        <!-- Loading Overlay -->
                        <div id="shoes-loading" class="loading-overlay" style="display: none;">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">Validando calzado...</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Summary -->
                <div id="upload-progress" class="helper-card success" style="display: none;">
                    <div class="helper-icon">✅</div>
                    <div class="helper-content">
                        <h5>Progreso de subida</h5>
                        <p id="progress-text">Listo para generar combinaciones</p>
                    </div>
                </div>
                
                <button class="hero-button" onclick="getRecommendation()" style="margin-top: 2rem; font-size: 1.2rem;" id="generateBtn">
                    🪄 Generar Combinaciones Inteligentes
                </button>
                
                <div id="result" style="display: none; margin-top: 3rem;"></div>
            </div>
        </div>
    </section>

    <section id="equipo">
        <div class="section-container">
            <div class="section-title">
                <h2>👥 Nuestro Equipo</h2>
                <p class="section-subtitle">Conoce a las personas detrás de AI love reuse</p>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 3rem; margin-top: 3rem;">
                <div class="feature-card" style="padding: 3rem; text-align: center;">
                    <h3>José Francisco Corti Badia</h3>
                    <p style="color: var(--accent); font-weight: 600; margin-bottom: 1rem;">Founder & CEO</p>
                    <p>Ingeniero Comercial, Diplomado en GenAI U. De Chile 2025 y Diplomado en AI PUC 2022. Experto en Inteligencia Artificial con más de 15 años creando soluciones en distintas industrias.</p>
                </div>
                
                <div class="feature-card" style="padding: 3rem; text-align: center;">
                    <h3>Paola Andrea Curti Simpson</h3>
                    <p style="color: var(--accent); font-weight: 600; margin-bottom: 1rem;">Directora Creativa</p>
                    <p>Arquitecta, especialista en moda sustentable con amplia experiencia en diseño y sostenibilidad.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="footer-cta">
        <div class="section-container">
            <h3>🚀 ¡Comienza Ahora!</h3>
            <p>Únete a miles de personas que ya están revolucionando su estilo de manera sostenible</p>
            
            <div class="cta-features">
                <div class="cta-feature">
                    <i class="fas fa-gift"></i>
                    <h4>Gratis</h4>
                    <p>Sin costo inicial</p>
                </div>
                <div class="cta-feature">
                    <i class="fas fa-clock"></i>
                    <h4>Instantáneo</h4>
                    <p>Resultados en 10 segundos</p>
                </div>
            </div>
            
            <div style="display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap; margin-top: 2rem;">
                <a href="#upload" class="btn-primary" onclick="handleStartNowClick(event)">
                    <i class="fas fa-play"></i>
                    Crear Mi Guardarropa Digital
                </a>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>AI love reuse</h3>
                <p>Maximiza tu ropa, minimiza tu Impacto Ambiental con nuestra tecnología de inteligencia artificial.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            
            <div class="footer-column">
                <h3>Enlaces Rápidos</h3>
                <a href="#inicio">Inicio</a>
                <a href="#impacto">Impacto Ambiental</a>
                <a href="#precios">Precios</a>
                <a href="#funcionamiento">Cómo Funciona</a>
                <a href="#equipo">Nuestro Equipo</a>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2024 AI love reuse. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        const GOOGLE_CLIENT_ID = '326940877598-ko13n1qcqkkugkoo6gu2n1avs46al09p.apps.googleusercontent.com';
        const API_BASE = "https://outfit-recommender.fly.dev";

        let isLoggedIn = false;
        let currentUser = null;
        let uploadedFiles = { tops: [], bottoms: [], shoes: [] };
        const FILE_LIMITS = { tops: 3, bottoms: 3, shoes: 5 };

        function handleStartNowClick(event) {
            event.preventDefault();
            
            if (!isLoggedIn) {
                showLoginPopup();
            } else {
                document.getElementById('upload').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function showLoginPopup() {
            const overlay = document.createElement('div');
            overlay.className = 'popup-overlay';
            
            overlay.innerHTML = `
                <div class="popup-content">
                    <span class="popup-icon">🚀</span>
                    <h3 style="color: var(--accent); margin-bottom: 1rem;">¡Empecemos!</h3>
                    <p class="popup-message">Para generar tus combinaciones personalizadas con IA, necesitas acceder con tu cuenta de Google.<br><br>
                    <strong>✅ Es completamente gratis</strong><br>
                    ✅ Solo necesitas tu email<br>
                    ✅ Sin spam ni publicidad</p>
                    <div class="popup-buttons" style="margin-top: 2rem;">
                        <button class="google-login-btn" onclick="loginFromPopup()" style="margin: 0; width: 100%;">
                            <svg width="18" height="18" viewBox="0 0 18 18">
                                <path fill="#4285F4" d="M17.64 9.20454546c0-.63818182-.05727273-1.25181818-.16363636-1.84090909H9v3.48090909h4.84378348c-.20892443.95363636-.84317059 1.76772727-1.68345427 2.31181818V15.52H14.88699909C16.67543111 13.84363636 17.64 11.7093333 17.64 9.20454546z"/>
                                <path fill="#34A853" d="M9 18c2.43 0 4.467-.80727273 5.95636364-2.18545455l-2.90909091-2.25818182c-.80636364.54-1.83727273.85909091-3.04727273.85909091-2.34545455 0-4.32818182-1.58545455-5.03636364-3.71818182L.68181818 12.5218182C2.24909091 15.5981818 5.48090909 18 9 18z"/>
                                <path fill="#FBBC4" d="M3.96363636 10.7109091c-.18-.54-.28363636-1.11818182-.28363636-1.7109091s.10363636-1.17090909.28363636-1.7109091V5.28181818L.68181818 5.28181818C.24727273 6.1418182 0 7.04727273 0 8s.24727273 1.8581818.68181818 2.7181818l3.28181818-1.27090909z"/>
                                <path fill="#EA4335" d="M9 3.57272727c1.32272727 0 2.50909091.45454545 3.44363636 1.34727273l2.58181818-2.58181818C13.46363636.89090909 11.42727273 0 9 0 5.48090909 0 2.24909091 2.40181818.68181818 5.28181818l3.28181818 1.27090909C4.67181818 5.15636364 6.65454545 3.57272727 9 3.57272727z"/>
                            </svg>
                            Acceder con Google - Es Gratis
                        </button>
                        <button class="popup-btn-secondary" onclick="closeLoginPopup()" style="margin-top: 1rem; width: 100%;">
                            Quizás más tarde
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(overlay);
            
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) closeLoginPopup();
            });
        }

        function showValidationPopup(type, title, message, validationErrors = null) {
            const overlay = document.createElement('div');
            overlay.className = 'popup-overlay validation-popup';
            
            let iconClass = '';
            let titleClass = '';
            
            switch(type) {
                case 'error':
                    iconClass = '❌';
                    titleClass = 'error';
                    break;
                case 'warning':
                    iconClass = '⚠️';
                    titleClass = 'warning';
                    break;
                case 'info':
                    iconClass = 'ℹ️';
                    titleClass = 'info';
                    break;
                default:
                    iconClass = '🤖';
                    titleClass = 'info';
            }

            let validationDetailsHtml = '';
            if (validationErrors && validationErrors.length > 0) {
                validationDetailsHtml = `
                    <div class="validation-details">
                        ${validationErrors.map(error => `
                            <div class="validation-item ${error.type || 'error'}">
                                <div class="validation-icon">
                                    ${error.type === 'warning' ? '⚠️' : error.type === 'success' ? '✅' : '❌'}
                                </div>
                                <div class="validation-content">
                                    <h4>${error.title || 'Error de Validación'}</h4>
                                    <p>${error.message || 'Error no especificado'}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            overlay.innerHTML = `
                <div class="popup-content">
                    <span class="popup-icon">${iconClass}</span>
                    <h3 class="popup-title ${titleClass}">${title}</h3>
                    <p class="popup-message">${message}</p>
                    ${validationDetailsHtml}
                    <div class="popup-buttons">
                        <button class="popup-btn popup-btn-primary" onclick="closeValidationPopup()">
                            Entendido
                        </button>
                        ${validationErrors ? `
                            <button class="popup-btn popup-btn-secondary" onclick="showUploadTips()">
                                Ver Consejos
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
            
            document.body.appendChild(overlay);
            
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) closeValidationPopup();
            });
        }

        function closeValidationPopup() {
            const popup = document.querySelector('.validation-popup');
            if (popup) {
                popup.style.animation = 'fadeOut 0.3s ease forwards';
                setTimeout(() => popup.remove(), 300);
            }
        }

        function showUploadTips() {
            closeValidationPopup();
            showValidationPopup('info', 'Consejos para Mejores Fotos', 
                'Para obtener mejores resultados, sigue estos consejos:', [
                {
                    type: 'success',
                    title: 'Iluminación Natural',
                    message: 'Toma las fotos con luz natural o buena iluminación artificial'
                },
                {
                    type: 'success', 
                    title: 'Fondo Neutro',
                    message: 'Usa fondos blancos, grises o neutros sin distracciones'
                },
                {
                    type: 'success',
                    title: 'Prenda Completa',
                    message: 'Asegúrate de que toda la prenda esté visible en la foto'
                },
                {
                    type: 'warning',
                    title: 'Evita Personas',
                    message: 'No incluyas personas usando las prendas en las fotos'
                }
            ]);
        }

        function updateStatusIndicator(type, status, message = '') {
            const indicator = document.getElementById(`${type}-status`);
            if (!indicator) return;

            indicator.style.display = 'block';
            indicator.className = `status-indicator ${status}`;
            indicator.title = message;

            switch(status) {
                case 'uploading':
                    indicator.innerHTML = '📤';
                    break;
                case 'validating':
                    indicator.innerHTML = '🔄';
                    break;
                case 'success':
                    indicator.innerHTML = '✅';
                    break;
                case 'error':
                    indicator.innerHTML = '❌';
                    break;
                case 'warning':
                    indicator.innerHTML = '⚠️';
                    break;
            }
        }

        function showLoadingOverlay(type, message = 'Procesando...') {
            const overlay = document.getElementById(`${type}-loading`);
            if (overlay) {
                overlay.style.display = 'flex';
                const textElement = overlay.querySelector('.loading-text');
                if (textElement) {
                    textElement.textContent = message;
                }
            }
        }

        function hideLoadingOverlay(type) {
            const overlay = document.getElementById(`${type}-loading`);
            if (overlay) {
                overlay.style.display = 'none';
            }
        }

        function updateUploadProgress() {
            const progressDiv = document.getElementById('upload-progress');
            const progressText = document.getElementById('progress-text');
            
            const topsCount = uploadedFiles.tops.length;
            const bottomsCount = uploadedFiles.bottoms.length; 
            const shoesCount = uploadedFiles.shoes.length;
            const totalItems = topsCount + bottomsCount + shoesCount;
            
            if (totalItems === 0) {
                progressDiv.style.display = 'none';
                return;
            }

            progressDiv.style.display = 'flex';
            
            if (topsCount > 0 && bottomsCount > 0 && shoesCount > 0) {
                progressDiv.className = 'helper-card success';
                const combinations = topsCount * bottomsCount * shoesCount;
                progressText.textContent = `¡Perfecto! Puedes generar ${combinations} combinaciones únicas`;
            } else {
                progressDiv.className = 'helper-card warning'; 
                const missing = [];
                if (topsCount === 0) missing.push('prendas superiores');
                if (bottomsCount === 0) missing.push('prendas inferiores');
                if (shoesCount === 0) missing.push('calzado');
                
                progressText.textContent = `Faltan: ${missing.join(', ')}. Total subido: ${totalItems} items`;
            }
        }

        function getFriendlyErrorMessage(backendError) {
            try {
                const errorString = JSON.stringify(backendError).toLowerCase();
                
                // Casos específicos del backend mejorado
                if (errorString.includes('mixed_categories') || errorString.includes('wrong_category')) {
                    return {
                        title: 'Categoría Incorrecta',
                        message: backendError.message || 'Has subido una prenda en la categoría equivocada',
                        suggestions: [
                            {
                                type: 'error',
                                title: 'Zapatos en Pantalones',
                                message: 'Parece que subiste zapatos en la sección de pantalones. Por favor, súbelos en la sección correcta.'
                            }
                        ]
                    };
                }
                
                if (errorString.includes('too_many_items')) {
                    return {
                        title: 'Límite Excedido',
                        message: backendError.message || 'Has superado el límite de fotos para esta categoría',
                        suggestions: [
                            {
                                type: 'warning',
                                title: 'Demasiadas Fotos',
                                message: 'Elimina algunas fotos antes de subir nuevas. Límites: 3 superiores, 3 inferiores, 5 zapatos.'
                            }
                        ]
                    };
                }
                
                if (errorString.includes('not_in_whitelist')) {
                    return {
                        title: 'Prenda No Reconocida',
                        message: 'No pudimos identificar una prenda válida en esta imagen',
                        suggestions: [
                            {
                                type: 'info',
                                title: 'Mejora la Foto',
                                message: 'Usa mejor iluminación, fondo neutro y asegúrate de que la prenda esté bien visible.'
                            }
                        ]
                    };
                }

                if (errorString.includes('low_confidence')) {
                    return {
                        title: 'Imagen Poco Clara',
                        message: 'La imagen no es lo suficientemente clara para el análisis',
                        suggestions: [
                            {
                                type: 'warning',
                                title: 'Calidad de Imagen',
                                message: 'Intenta con mejor iluminación, enfoque más nítido o ángulo diferente.'
                            }
                        ]
                    };
                }
                
                return {
                    title: 'Error de Procesamiento',
                    message: backendError.message || 'Error procesando la imagen',
                    suggestions: []
                };
                
            } catch (error) {
                console.error('Error parseando mensaje:', error);
                return {
                    title: 'Error Inesperado',
                    message: 'Ocurrió un error. Por favor intenta nuevamente.',
                    suggestions: []
                };
            }
        }

        function loginFromPopup() {
            closeLoginPopup();
            loginWithGoogle();
        }

        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const overlay = document.getElementById('mobileMenuOverlay');
            const hamburger = document.getElementById('hamburgerBtn');
            
            const isActive = mobileMenu.classList.contains('active');
            
            if (isActive) {
                closeMobileMenu();
            } else {
                mobileMenu.classList.add('active');
                overlay.classList.add('active');
                hamburger.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const overlay = document.getElementById('mobileMenuOverlay');
            const hamburger = document.getElementById('hamburgerBtn');
            
            mobileMenu.classList.remove('active');
            overlay.classList.remove('active');
            hamburger.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function initializeGoogleAuth() {
            if (typeof google === 'undefined' || !google.accounts) return;

            try {
                google.accounts.id.initialize({
                    client_id: GOOGLE_CLIENT_ID,
                    callback: handleGoogleSignIn,
                    auto_select: false,
                    cancel_on_tap_outside: true
                });
            } catch (error) {
                console.error('Error inicializando Google OAuth:', error);
            }
        }

        function handleGoogleSignIn(response) {
            try {
                if (!response.credential) {
                    throw new Error('No se recibió credencial de Google');
                }

                const token = response.credential;
                const payload = JSON.parse(atob(token.split('.')[1]));
                
                currentUser = {
                    name: payload.name,
                    email: payload.email,
                    picture: payload.picture,
                    given_name: payload.given_name,
                    token: token
                };
                
                isLoggedIn = true;
                updateAuthUI();
                showUploadSection();
                showNotification(`¡Bienvenido ${currentUser.given_name || currentUser.name}!`, 'success', 4000);
                
                setTimeout(() => {
                    document.getElementById('upload').scrollIntoView({ behavior: 'smooth' });
                }, 1000);
                
            } catch (error) {
                console.error('Error procesando login:', error);
                showNotification('Error al iniciar sesión: ' + error.message, 'error');
            }
        }

        async function loginWithGoogle() {
            try {
                if (typeof google === 'undefined' || !google.accounts) {
                    throw new Error('Servicios de Google no disponibles');
                }
                google.accounts.id.prompt();
            } catch (error) {
                showNotification('Error: ' + error.message, 'error');
            }
        }

        function logout() {
            try {
                if (typeof google !== 'undefined' && google.accounts?.id) {
                    google.accounts.id.disableAutoSelect();
                }
            } catch (error) {
                console.error('Error en logout:', error);
            }
            
            isLoggedIn = false;
            currentUser = null;
            uploadedFiles = { tops: [], bottoms: [], shoes: [] };
            
            ['tops', 'bottoms', 'shoes'].forEach(type => {
                const preview = document.getElementById(`${type}-preview`);
                if (preview) preview.innerHTML = '';
            });
            
            updateAuthUI();
            hideUploadSection();
            showNotification('Sesión cerrada correctamente', 'info', 3000);
        }

        function updateAuthUI() {
            const userInfo = document.getElementById('userInfo');
            
            if (isLoggedIn && currentUser) {
                if (userInfo) {
                    userInfo.style.display = 'flex';
                    const userName = document.getElementById('userName');
                    const userAvatar = document.getElementById('userAvatar');
                    if (userName) userName.textContent = currentUser.name || currentUser.email;
                    if (userAvatar) userAvatar.src = currentUser.picture || '';
                }
            } else {
                if (userInfo) userInfo.style.display = 'none';
            }
        }

        function showUploadSection() {
            const loginRequired = document.getElementById('loginRequired');
            const uploadArea = document.getElementById('uploadArea');
            
            if (loginRequired) loginRequired.style.display = 'none';
            if (uploadArea) uploadArea.style.display = 'block';
        }

        function hideUploadSection() {
            const loginRequired = document.getElementById('loginRequired');
            const uploadArea = document.getElementById('uploadArea');
            const resultDiv = document.getElementById('result');
            
            if (loginRequired) loginRequired.style.display = 'none';
            if (uploadArea) uploadArea.style.display = 'none';
            if (resultDiv) {
                resultDiv.innerHTML = '';
                resultDiv.style.display = 'none';
            }
        }

        async function handleFileUpload(type, input) {
            if (!isLoggedIn) {
                showValidationPopup('error', 'Inicia Sesión Requerida', 
                    'Necesitas iniciar sesión con Google para subir fotos y usar la IA de recomendaciones.');
                input.value = '';
                return;
            }

            const files = Array.from(input.files);
            if (files.length === 0) return;

            const currentCount = uploadedFiles[type].length;
            const maxFiles = FILE_LIMITS[type];
            const availableSlots = maxFiles - currentCount;
            
            if (files.length > availableSlots) {
                const typeText = type === 'tops' ? 'superiores' : 
                               type === 'bottoms' ? 'inferiores' : 'zapatos';
                
                showValidationPopup('warning', 'Límite de Fotos Excedido', 
                    `Solo puedes subir ${availableSlots} foto${availableSlots !== 1 ? 's' : ''} más de ${typeText}.`, 
                    [{
                        type: 'warning',
                        title: 'Límite Actual',
                        message: `Máximo permitido: ${maxFiles} fotos por categoría. Actualmente tienes: ${currentCount}`
                    }]);
                input.value = '';
                return;
            }
            
            // Mostrar estado de subida
            updateStatusIndicator(type, 'uploading', 'Subiendo archivos...');
            showLoadingOverlay(type, 'Subiendo y validando imágenes...');
            
            let successCount = 0;
            let errorCount = 0;
            const processingErrors = [];
            
            for (let [index, file] of files.entries()) {
                try {
                    // Validación básica del archivo
                    await validateClothingImage(file);
                    
                    // Simular validación con backend (puedes reemplazar esto con llamada real)
                    await simulateBackendValidation(file, type);
                    
                    // Procesar imagen si pasa validación
                    const preview = document.getElementById(`${type}-preview`);
                    await processImageFile(file, type, preview);
                    uploadedFiles[type].push(file);
                    successCount++;
                    
                    // Actualizar progreso
                    showLoadingOverlay(type, `Procesando imagen ${index + 1} de ${files.length}...`);
                    
                } catch (error) {
                    errorCount++;
                    console.error(`Error procesando ${file.name}:`, error);
                    
                    const friendlyError = getFriendlyErrorMessage(error);
                    processingErrors.push({
                        type: 'error',
                        title: `Error en ${file.name}`,
                        message: friendlyError.message || error.message
                    });
                }
            }
            
            // Ocultar loading
            hideLoadingOverlay(type);
            
            // Actualizar estado final
            if (successCount > 0 && errorCount === 0) {
                updateStatusIndicator(type, 'success', `${successCount} imagen${successCount !== 1 ? 'es' : ''} subida${successCount !== 1 ? 's' : ''} correctamente`);
            } else if (successCount > 0 && errorCount > 0) {
                updateStatusIndicator(type, 'warning', `${successCount} exitosas, ${errorCount} con errores`);
            } else if (errorCount > 0) {
                updateStatusIndicator(type, 'error', `${errorCount} imagen${errorCount !== 1 ? 'es' : ''} con errores`);
            }
            
            // Actualizar labels y progreso
            updateUploadLabel(type);
            updateUploadProgress();
            updateGenerateButton();
            
            // Mostrar popup de resultados si hay errores
            if (processingErrors.length > 0) {
                const title = errorCount === files.length ? 'Errores de Validación' : 'Algunas Imágenes con Problemas';
                const message = errorCount === files.length ? 
                    'No se pudo procesar ninguna imagen. Revisa los errores a continuación:' :
                    `Se procesaron ${successCount} imagen${successCount !== 1 ? 'es' : ''} correctamente, pero ${errorCount} tuvieron problemas:`;
                
                showValidationPopup('error', title, message, processingErrors);
            } else if (successCount > 0) {
                const typeText = type === 'tops' ? 'superiores' : 
                               type === 'bottoms' ? 'inferiores' : 'zapatos';
                showNotification(`${successCount} foto${successCount !== 1 ? 's' : ''} de ${typeText} subida${successCount !== 1 ? 's' : ''} correctamente`, 'success', 3000);
            }
            
            input.value = '';
        }

        async function simulateBackendValidation(file, type) {
            // Simula validación del backend - reemplaza con llamada real
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    // Simular algunos casos de error para demostración
                    const rand = Math.random();
                    
                    if (rand < 0.1) { // 10% de probabilidad de error de categoría
                        reject({
                            code: 'WRONG_CATEGORY',
                            message: `Esta imagen parece ser ${type === 'tops' ? 'calzado' : 'una prenda superior'}, no ${type === 'tops' ? 'una prenda superior' : 'calzado'}. Súbela en la categoría correcta.`,
                            field: type
                        });
                    } else if (rand < 0.15) { // 5% de probabilidad de imagen poco clara
                        reject({
                            code: 'LOW_CONFIDENCE',
                            message: 'La imagen no es lo suficientemente clara para identificar la prenda correctamente.',
                            confidence: 0.3
                        });
                    } else {
                        resolve(); // Validación exitosa
                    }
                }, 1000 + Math.random() * 2000); // Simular tiempo de procesamiento variable
            });
        }

        async function validateClothingImage(file) {
            const validTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];
            if (!validTypes.includes(file.type)) {
                throw new Error('Formato no compatible. Usa JPG, PNG, WEBP o GIF.');
            }
            
            if (file.size > 20 * 1024 * 1024) { // 20MB
                throw new Error(`Archivo muy grande: ${(file.size / (1024 * 1024)).toFixed(1)}MB. Máximo: 20MB`);
            }
            
            if (file.size < 1024) { // 1KB mínimo
                throw new Error('El archivo parece estar corrupto o es muy pequeño.');
            }
            
            return true;
        }

        function updateUploadLabel(type) {
            const label = document.querySelector(`label[for="${type}-upload"]`);
            const count = uploadedFiles[type].length;
            const maxFiles = FILE_LIMITS[type];
            const typeText = type === 'tops' ? 'Superiores' : 
                           type === 'bottoms' ? 'Inferiores' : 'Zapatos';
            
            if (count === 0) {
                label.innerHTML = `📤 Subir ${typeText} (máx ${maxFiles})`;
                label.style.background = 'linear-gradient(135deg, var(--accent), var(--accent-light))';
            } else if (count < maxFiles) {
                label.innerHTML = `✅ ${count}/${maxFiles} - Agregar más`;
                label.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
            } else {
                label.innerHTML = `🎯 ${count}/${maxFiles} - ¡Completo!`;
                label.style.background = 'linear-gradient(135deg, #ffc107, #ff9800)';
            }
        }

        function updateGenerateButton() {
            const button = document.getElementById('generateBtn');
            const hasAll = uploadedFiles.tops.length > 0 && 
                          uploadedFiles.bottoms.length > 0 && 
                          uploadedFiles.shoes.length > 0;
            
            if (hasAll) {
                const totalCombinations = uploadedFiles.tops.length * uploadedFiles.bottoms.length * uploadedFiles.shoes.length;
                button.innerHTML = `🪄 Generar ${totalCombinations} Combinaciones Inteligentes`;
                button.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
                button.disabled = false;
            } else {
                button.innerHTML = '🪄 Sube fotos de cada categoría para continuar';
                button.style.background = 'linear-gradient(135deg, #6c757d, #5a6268)';
                button.disabled = true;
            }
        }

        function processImageFile(file, type, preview) {
            return new Promise((resolve, reject) => {
                if (!file.type.startsWith('image/')) {
                    reject(new Error('Solo se permiten imágenes'));
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const container = document.createElement('div');
                    container.style.position = 'relative';
                    container.style.display = 'inline-block';
                    container.style.margin = '0.25rem';
                    
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-image';
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-image';
                    removeBtn.innerHTML = '×';
                    removeBtn.onclick = () => {
                        container.remove();
                        const fileIndex = uploadedFiles[type].indexOf(file);
                        if (fileIndex > -1) {
                            uploadedFiles[type].splice(fileIndex, 1);
                        }
                    };
                    
                    container.appendChild(img);
                    container.appendChild(removeBtn);
                    preview.appendChild(container);
                    resolve();
                };
                reader.onerror = () => reject(new Error('Error leyendo el archivo'));
                reader.readAsDataURL(file);
            });
        }

        async function getRecommendation() {
            if (!isLoggedIn) {
                showNotification('Necesitas iniciar sesión primero', 'error');
                return;
            }

            if (uploadedFiles.tops.length === 0 || uploadedFiles.bottoms.length === 0 || uploadedFiles.shoes.length === 0) {
                showNotification('Necesitas subir al menos una foto de cada categoría', 'error');
                return;
            }

            const button = document.getElementById('generateBtn');
            const originalText = button.innerHTML;
            button.innerHTML = '<span class="loading"></span> Generando combinaciones...';
            button.disabled = true;

            try {
                const formData = new FormData();
                formData.append('user_email', currentUser.email);
                
                uploadedFiles.tops.forEach((file) => {
                    formData.append('tops', file);
                });
                uploadedFiles.bottoms.forEach((file) => {
                    formData.append('bottoms', file);
                });
                uploadedFiles.shoes.forEach((file) => {
                    formData.append('shoes', file);
                });

                const response = await fetch(`${API_BASE}/recommend`, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error('Error del servidor');
                }

                const data = await response.json();
                showNotification('Recomendaciones generadas exitosamente!', 'success');
                
            } catch (error) {
                showNotification('Error generando recomendaciones', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function startFreePlan() {
            if (!isLoggedIn) {
                showLoginPopup();
                return;
            }
            showNotification('Plan gratuito activado!', 'success');
            document.getElementById('upload').scrollIntoView({ behavior: 'smooth' });
        }

        function upgradeToPremium() {
            showNotification('Funcionalidad en desarrollo', 'info');
        }

        function showNotification(message, type = 'info', duration = 4000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, duration);
        }

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                if (this.getAttribute('onclick')) return;
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                    closeMobileMenu();
                }
            });
        });

        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                closeMobileMenu();
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            updateAuthUI();
            
            const checkGoogleLoaded = () => {
                if (typeof google !== 'undefined' && google.accounts) {
                    initializeGoogleAuth();
                } else {
                    setTimeout(checkGoogleLoaded, 500);
                }
            };
            
            setTimeout(checkGoogleLoaded, 1500);
            
            setTimeout(() => {
                const impactBars = document.querySelectorAll('.impact-fill');
                impactBars.forEach((bar, index) => {
                    setTimeout(() => {
                        const width = bar.getAttribute('data-width');
                        bar.style.width = width + '%';
                    }, index * 200);
                });
            }, 3000);
        });
    </script>
</body>
</html>
